<div class="well-content-form">
  <style>
    .stock-solution-search-dropdown {
      z-index: 1060;
      border: 1px solid #dee2e6;
      border-radius: 0.375rem;
      box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
      background-color: white;
    }
    
    .stock-solution-search-dropdown .dropdown-item {
      padding: 0.5rem 1rem;
      border: none;
      background: none;
      text-align: left;
      width: 100%;
      cursor: pointer;
    }
    
    .stock-solution-search-dropdown .dropdown-item:hover {
      background-color: #f8f9fa;
    }
    
    .stock-solution-search-dropdown .dropdown-item:focus {
      background-color: #e9ecef;
    }
  </style>
  
  <div class="mb-3">
    <h6>Current Stock Solutions</h6>
    <% if well_contents.any? %>
      <div class="list-group">
        <% well_contents.each do |content| %>
          <div class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <strong><%= content.stock_solution.display_name %></strong>
              <% if content.volume.present? %>
                <div class="small text-muted">
                  Volume: <%= content.display_volume %>
                </div>
              <% end %>
              <% if content.stock_solution.stock_solution_components.any? %>
                <div class="small text-muted">
                  <%= content.stock_solution.component_summary %>
                </div>
              <% end %>
            </div>
            <button type="button" class="btn btn-sm btn-outline-danger" 
                    data-action="remove-stock-solution" 
                    data-well-id="<%= well.id %>" 
                    data-content-id="<%= content.id %>">
              Remove
            </button>
          </div>
        <% end %>
      </div>
      <button type="button" class="btn btn-sm btn-outline-warning mt-2" 
              data-action="remove-all-content" 
              data-well-id="<%= well.id %>">
        Remove All
      </button>
    <% else %>
      <p class="text-muted">No stock solutions added yet.</p>
    <% end %>
  </div>

  <div class="mb-3">
    <h6>Add Stock Solution</h6>
    <div class="mb-3">
      <label for="stockSolutionSearch_<%= well.id %>" class="form-label">Stock Solution</label>
      <div class="position-relative">
        <input type="hidden" id="stockSolutionId_<%= well.id %>">
        <input type="text" class="form-control" id="stockSolutionSearch_<%= well.id %>" 
               placeholder="Search by name or components..."
               oninput="searchStockSolutions(this, 'stockSolutionId_<%= well.id %>', 'stockSolutionResults_<%= well.id %>')"
               onblur="setTimeout(() => hideStockSolutionResults('stockSolutionResults_<%= well.id %>'), 200)">
        <div class="stock-solution-search-dropdown position-absolute w-100 d-none" 
             style="top: 100%; max-height: 200px; overflow-y: auto;"
             id="stockSolutionResults_<%= well.id %>">
        </div>
      </div>
    </div>
    
    <div class="mb-3">
      <label for="volumeAmountInput_<%= well.id %>" class="form-label">Volume</label>
      <input type="text" class="form-control" id="volumeAmountInput_<%= well.id %>" 
             placeholder="Enter volume with unit (e.g., 50 ul, 1.5 ml, 0.25 l)">
      <div class="form-text">
        Enter volume with unit. Available units: 
        <% units.each_with_index do |unit, index| %>
          <span class="badge bg-secondary me-1"><%= unit.symbol %></span><%= index < units.size - 1 ? '' : '' %>
        <% end %>
        <br><small class="text-muted">Note: You can use "ul" instead of "Âµl" for microliters</small>
      </div>
    </div>
    
    <button type="button" class="btn btn-primary" data-action="add-stock-solution" data-well-id="<%= well.id %>">
      Add Stock Solution
    </button>
  </div>

  <div id="contentMessages_<%= well.id %>"></div>
</div>
